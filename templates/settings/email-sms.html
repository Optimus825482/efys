{% extends 'base.html' %}
{% block title %}Email/SMS AyarlarÄ±{% endblock %}
{% block page_title %}Email/SMS Bildirimleri{% endblock %}
{% set breadcrumb = [{'name': 'Ayarlar', 'url': url_for('settings.index')}, {'name': 'Email/SMS'}] %}

{% block content %}
<div class="grid grid-cols-2 gap-4">
    <!-- Email AyarlarÄ± -->
    <div class="card">
        <div class="card-header">
            <h3 class="card-title">ðŸ“§ Email Sunucu AyarlarÄ±</h3>
        </div>
        <div class="card-body">
            <form id="email-form">
                <div class="form-group">
                    <label class="form-label">SMTP Sunucu</label>
                    <input type="text" class="form-input" id="smtp-host"
                        value="{{ settings.smtp_host or 'smtp.gmail.com' }}" />
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div class="form-group">
                        <label class="form-label">Port</label>
                        <input type="number" class="form-input" id="smtp-port"
                            value="{{ settings.smtp_port or 587 }}" />
                    </div>
                    <div class="form-group">
                        <label class="form-label">GÃ¼venlik</label>
                        <select class="form-select" id="smtp-security">
                            <option value="tls" {{ 'selected' if settings.smtp_security=='tls' else '' }}>TLS</option>
                            <option value="ssl" {{ 'selected' if settings.smtp_security=='ssl' else '' }}>SSL</option>
                            <option value="none" {{ 'selected' if settings.smtp_security=='none' else '' }}>Yok</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">KullanÄ±cÄ± AdÄ±</label>
                    <input type="email" class="form-input" id="smtp-user" value="{{ settings.smtp_user or '' }}"
                        placeholder="email@example.com" />
                </div>
                <div class="form-group">
                    <label class="form-label">Åžifre</label>
                    <input type="password" class="form-input" id="smtp-pass" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" />
                </div>
                <div class="form-group">
                    <label class="form-label">GÃ¶nderen AdÄ±</label>
                    <input type="text" class="form-input" id="sender-name"
                        value="{{ settings.sender_name or 'GÃ¶nen OSB EFYS' }}" />
                </div>
                <div style="display: flex; gap: 8px;">
                    <button type="button" class="btn btn-secondary" onclick="testEmail()">Test GÃ¶nder</button>
                    <button type="submit" class="btn btn-primary">Kaydet</button>
                </div>
            </form>
        </div>
    </div>

    <!-- SMS AyarlarÄ± -->
    <div class="card">
        <div class="card-header">
            <h3 class="card-title">ðŸ“± SMS Gateway AyarlarÄ±</h3>
        </div>
        <div class="card-body">
            <form id="sms-form">
                <div class="form-group">
                    <label class="form-label">SMS SaÄŸlayÄ±cÄ±</label>
                    <select class="form-select" id="sms-provider">
                        <option value="netgsm" {{ 'selected' if settings.sms_provider=='netgsm' else '' }}>Netgsm
                        </option>
                        <option value="iletimerkezi" {{ 'selected' if settings.sms_provider=='iletimerkezi' else '' }}>
                            Ä°leti Merkezi</option>
                        <option value="mutlucell" {{ 'selected' if settings.sms_provider=='mutlucell' else '' }}>
                            Mutlucell</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">API KullanÄ±cÄ±</label>
                    <input type="text" class="form-input" id="sms-user" value="{{ settings.sms_user or '' }}" />
                </div>
                <div class="form-group">
                    <label class="form-label">API Åžifre/Token</label>
                    <input type="password" class="form-input" id="sms-pass" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" />
                </div>
                <div class="form-group">
                    <label class="form-label">GÃ¶nderen BaÅŸlÄ±k</label>
                    <input type="text" class="form-input" id="sms-header"
                        value="{{ settings.sms_header or 'GONENOSB' }}" maxlength="11" />
                </div>
                <div style="display: flex; gap: 8px;">
                    <button type="button" class="btn btn-secondary" onclick="testSms()">Test GÃ¶nder</button>
                    <button type="submit" class="btn btn-primary">Kaydet</button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Bildirim ÅžablonlarÄ± -->
<div class="card mt-4">
    <div class="card-header">
        <h3 class="card-title">ðŸ“‹ Bildirim ÅžablonlarÄ±</h3>
    </div>
    <div class="card-body" style="padding: 0;">
        <table class="table">
            <thead>
                <tr>
                    <th>Åžablon</th>
                    <th>AÃ§Ä±klama</th>
                    <th>Email</th>
                    <th>SMS</th>
                    <th>Ä°ÅŸlem</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>fatura_bildirim</strong></td>
                    <td>Yeni fatura kesildiÄŸinde gÃ¶nderilir</td>
                    <td><span class="badge badge-success">Aktif</span></td>
                    <td><span class="badge badge-success">Aktif</span></td>
                    <td><button class="btn btn-secondary btn-sm">DÃ¼zenle</button></td>
                </tr>
                <tr>
                    <td><strong>vade_hatirlatma</strong></td>
                    <td>Vade tarihinden 3 gÃ¼n Ã¶nce</td>
                    <td><span class="badge badge-success">Aktif</span></td>
                    <td><span class="badge badge-warning">Pasif</span></td>
                    <td><button class="btn btn-secondary btn-sm">DÃ¼zenle</button></td>
                </tr>
                <tr>
                    <td><strong>odeme_onay</strong></td>
                    <td>Ã–deme alÄ±ndÄ±ÄŸÄ±nda gÃ¶nderilir</td>
                    <td><span class="badge badge-success">Aktif</span></td>
                    <td><span class="badge badge-warning">Pasif</span></td>
                    <td><button class="btn btn-secondary btn-sm">DÃ¼zenle</button></td>
                </tr>
                <tr>
                    <td><strong>reaktif_uyari</strong></td>
                    <td>Reaktif ceza riski tespit edildiÄŸinde</td>
                    <td><span class="badge badge-success">Aktif</span></td>
                    <td><span class="badge badge-success">Aktif</span></td>
                    <td><button class="btn btn-secondary btn-sm">DÃ¼zenle</button></td>
                </tr>
            </tbody>
        </table>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    document.getElementById( 'email-form' ).addEventListener( 'submit', async function ( e ) {
        e.preventDefault();
        alert( 'Email ayarlarÄ± kaydedildi (Demo)' );
    } );

    document.getElementById( 'sms-form' ).addEventListener( 'submit', async function ( e ) {
        e.preventDefault();
        alert( 'SMS ayarlarÄ± kaydedildi (Demo)' );
    } );

    function testEmail() {
        const email = prompt( 'Test emaili gÃ¶nderilecek adres:', 'test@example.com' );
        if ( email ) {
            alert( `Test emaili ${email} adresine gÃ¶nderildi (Demo)` );
        }
    }

    function testSms() {
        const phone = prompt( 'Test SMS gÃ¶nderilecek numara:', '05XX XXX XX XX' );
        if ( phone ) {
            alert( `Test SMS ${phone} numarasÄ±na gÃ¶nderildi (Demo)` );
        }
    }
</script>
{% endblock %}